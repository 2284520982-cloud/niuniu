# 🚀 Niuniu Java 安全审计工具 - 启动指南

## 一键启动（最简单的方式）

### Windows 用户

1. **双击运行** `start.bat` 文件
2. 等待服务启动（会自动安装依赖）
3. 浏览器打开 `http://localhost:7777/static/index.html`

### Linux/Mac 用户

1. **终端执行**：
   ```bash
   chmod +x start.sh
   ./start.sh
   ```
2. 等待服务启动
3. 浏览器打开 `http://localhost:7777/static/index.html`

### 通用方式（Python脚本）

```bash
python start.py
```

## 使用步骤

### 第一步：启动服务

按照上面的方式启动服务，看到以下信息表示启动成功：
```
INFO:     Started server process
INFO:     Uvicorn running on http://0.0.0.0:7777
```

### 第二步：打开前端

浏览器访问：`http://localhost:7777/static/index.html`

### 第三步：配置扫描

1. **填写项目路径**：输入要扫描的Java项目路径
   - 例如：`D:/Code/Github/java-sec-code`
   - 或者：`/home/user/projects/my-java-app`

2. **规则路径**：会自动填充，通常不需要修改
   - 默认：`Rules/rules.json`

3. **选择引擎**：
   - **lite**：快速扫描（推荐）
   - **original**：完整扫描（包含代码提取）

4. **配置参数**（可选）：
   - 回溯深度：15（推荐）
   - 最大链条数：50
   - 单链路超时：600秒
   - 模板扫描：开启
   - Lite 富化：开启（推荐）

### 第四步：开始扫描

点击 **"开始扫描"** 按钮，等待扫描完成。

## 故障排除

### 问题1：端口被占用

**解决方法**：
- 修改 `app.py` 最后一行，更改端口号
- 或关闭占用7777端口的程序

### 问题2：依赖安装失败

**解决方法**：
```bash
# 使用国内镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 问题3：Python版本过低

**要求**：Python 3.8+

**检查版本**：
```bash
python --version
```

### 问题4：前端无法访问

**检查后端**：
1. 访问 `http://localhost:7777/api/ping`
2. 应该返回 `{"ok": true}`

**检查控制台**：
- 打开浏览器开发者工具（F12）
- 查看Console是否有错误

## 快速测试

### 测试后端API

```bash
# 健康检查
curl http://localhost:7777/api/ping

# 应该返回: {"ok": true}
```

### 测试前端

1. 打开 `http://localhost:7777/static/index.html`
2. 页面应该正常加载
3. 点击"开始扫描"按钮，即使没有填写项目路径也应该有提示

## 默认配置说明

- **服务地址**：`http://localhost:7777`
- **前端页面**：`http://localhost:7777/static/index.html`
- **默认端口**：7777
- **规则文件**：`Rules/rules.json`（自动加载所有增强规则）
- **默认深度**：15层
- **默认超时**：600秒

## 目录结构说明

```
niuniu/
├── start.bat          # Windows启动脚本
├── start.sh           # Linux/Mac启动脚本
├── start.py           # Python启动脚本
├── app.py             # 主应用（可直接运行）
├── analyzer.py        # 分析器核心
├── Rules/             # 规则目录
│   ├── rules.json     # 基础规则
│   ├── enhanced_*.json # 增强规则
│   └── comprehensive_rules.json # 综合规则
├── static/            # 前端文件
│   ├── index.html     # 主页面
│   └── js/            # JavaScript模块
└── requirements.txt   # Python依赖
```

## 常见问题

### Q: 首次运行需要做什么？

A: 首次运行时会自动检查并安装依赖，无需手动操作。

### Q: 如何修改端口？

A: 编辑 `app.py` 文件最后一行，修改端口号：
```python
uvicorn.run(app, host='0.0.0.0', port=7777)  # 改成其他端口
```

### Q: 规则文件在哪里？

A: 所有规则文件都在 `Rules/` 目录下，系统会自动加载所有规则。

### Q: 扫描结果保存在哪里？

A: 扫描结果保存在 `reports/` 目录下：
- `last_partial.json` - 最新部分结果
- `vulns.json` - 完整漏洞结果

### Q: 如何停止服务？

A: 在运行服务的终端窗口按 `Ctrl+C`

## 更多帮助

- 查看 `docs/` 目录下的详细文档
- 查看 `README.md` 了解项目详情
- 查看 `快速启动说明.txt` 获取快速参考

